elasticsearch
====
分布式全文搜索引擎，主要功能是对大数据的存储以及近似实时的搜索与分析功能

### 数据存储方式
面向文档的存储方式，并且对内容进行索引。<br>

#### 索引与文档
**索引**：作为名词时，可以类比于关系型数据库中的表。作为动词时就是将文档写入索引中(包括倒排索引与Doc value的建立)，便于被检索的过程。

**文档**：

#### 数据存储结构

**倒排索引**：

**doc values**：

**Lucene存储**

#### 分布式与容错机制
**路由分片**：根据如下公式计算该文档所在的分片id，然后放入到相应分片中。
> shard = hash(routing) % number_of_primary_shards routing默认是文档的id，也可以自定义，跟文档有关的api都会接受一个routing的参数，通过这个参数自定义文档到分片的映射。<br>
这就解释了在创建索引时就定义好分片数量，一旦确定好后就不能再改变，否则之前的路由就会失效。

**分片容错**：每一个逻辑分片会对应主分片和副本分片。

### 搜索功能
默认的，文档中的每一个属性都是会被索引和可搜索的。

**分析器**<br>
由字符过滤器，分词器，词单元过滤器三个函数构成的一个包装类，这三个函数按照顺序执行。<br>
字符过滤器用于过滤掉那些不想被索引的词。如：html标签等<br>
把字符串分解成单个词条或者词汇单元。<br>
词单元过滤器：经过分词，作为结果的 词单元流 会按照指定的顺序通过指定的词单元过滤器 。词单元过滤器可以修改、添加或者移除词单元，如大小写统一，去掉停用词等。

测试分析器：

**自定义分词器**：


### 统计分析


### 集群相关

### 优化

#### 配置优化

#### 搜索优化

#### 索引优化

### kibana使用
#### 搜索
数字区间搜索：count: >300 AND count: <1000    其中count时字段名称

#### 统计

